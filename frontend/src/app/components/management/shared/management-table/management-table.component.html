<div class="management-table">
    <div class="management-table-header">
        <div class="management-table-search" *ngIf="{ pagination: pagination|async, search: search|async } as data">
            <span class="input-icon icon-search"></span>
            <input type="text" class="form-control"
               [ngModel]="data.search"
               (ngModelChange)="searcher.next($event)"
               [placeholder]="'general.buttons.search' | translate"
            >
        </div>
    </div>
    <div class="management-table-body">
        <ng-container *ngIf="{ loading: loading|async, items: filteredData|async, columns: columns|async, ordering: ordering|async } as data">
            <div class="responsive-table" *ngIf="!data.loading && data.items && data.items.length > 0">
                <table>
                    <thead>
                        <tr>
                            <th *ngFor="let column of data.columns">
                                <div class="d-flex align-items-center">
                                    {{ column | translate }} <span class="ms-1" (click)="toggleOrderBy(data.ordering, column)" [ngClass]="getOrderIconClass(data.ordering, column)"></span>
                                </div>
                            </th>
                            <th *ngIf="actions.length">
                                {{ 'management.managementTable.actions' | translate }}
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                    <tr *ngFor="let item of data.items">
                        <ng-container *ngIf="mapper(item) as mappedItem">
                            <td *ngFor="let column of data.columns">
                                {{ mappedItem[column] }}
                            </td>
                            <td *ngIf="actions.length">
                                <div class="actions">
                                    <span class="action" *ngFor="let action of actions" [ngClass]="action.getIcon()" (click)="action.handle(item)">

                                    </span>
                                </div>
                            </td>
                        </ng-container>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="no-results" *ngIf="!data.loading && data.items && !data.items.length">
                <div class="icon">
                    <span class="icon-cross"></span>
                </div>
                <p>
                    {{ 'management.general.noResults' | translate }}
                </p>
            </div>
            <div class="loading" *ngIf="data.loading">
                <div class="icon">
                    <span class="icon-clock"></span>
                </div>
                <p>
                    {{ 'management.general.loading' | translate }}
                </p>
            </div>
        </ng-container>
    </div>
    <ng-container *ngIf="{items: searchedData|async, pagination: pagination|async, loading: loading|async} as data">
        <div class="management-table-footer" *ngIf="!data.loading && data.items && data.items.length">
            <div class="pagination-info">
                {{ 'management.managementTable.pagination.info' | translate: { startIndex: getStartIndex(data.pagination), endIndex: getEndIndex(data.pagination, data.items.length), total: data.items.length } }}
            </div>
            <div class="results-picker">
                <div class="results-picker-container">
                    <select [ngModel]="data.pagination.perPage" (ngModelChange)="setPerPage($event)">
                        <option *ngFor="let option of getPerPageOptions(data.pagination)" [value]="option">
                            {{ option }}
                        </option>
                    </select>
                </div>
            </div>
            <div class="pagination d-none d-md-flex" *ngIf="hasPages(data.pagination, data.items.length)">
                <div class="pagination-wrapper">
                    <div class="pagination-item nav" (click)="previousPage(data.pagination)" *ngIf="hasPreviousPage(data.pagination)">
                        <span class="icon-chevron-left"></span>
                    </div>
                    <div class="pagination-item" [ngClass]="{active: isCurrentPage(data.pagination, page)}" *ngFor="let page of getPages(data.pagination, data.items.length)" (click)="setCurrentPage(data.pagination, page)">
                        {{ page }}
                    </div>
                    <div class="pagination-item nav" (click)="nextPage(data.pagination, data.items.length)" *ngIf="hasNextPage(data.pagination, data.items.length)">
                        <span class="icon-chevron-right"></span>
                    </div>
                </div>
            </div>
        </div>
    </ng-container>
</div>
